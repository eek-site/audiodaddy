<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Audio Daddy | Pay-Per-Minute Transcription | No Subscriptions</title>
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17834457969"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'AW-17834457969');
  </script>
  
  <!-- Geo-redirect non-UK visitors (unless they have gclid) -->
  <script>
    (function() {
      const params = new URLSearchParams(window.location.search);
      // Allow through if: has gclid, has bypass, or already redirected
      if (params.has('gclid') || params.has('bypass') || sessionStorage.getItem('geo_checked')) {
        return;
      }
      // Check country and redirect if not UK
      fetch('https://ipapi.co/json/')
        .then(r => r.json())
        .then(data => {
          sessionStorage.setItem('geo_checked', '1');
          if (data.country_code && data.country_code !== 'GB') {
            window.location.href = '/international.html';
          }
        })
        .catch(() => sessionStorage.setItem('geo_checked', '1'));
    })();
  </script>
  <meta name="description" content="Transcribe audio to text instantly. Pay only for what you use. No subscriptions, no signups, no nonsense. Built by an entrepreneur who was sick of getting ripped off." />
  <meta name="keywords" content="audio transcription, speech to text, transcribe audio, pay per minute, no subscription" />
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="canonical" href="https://audiodaddy.co.uk/" />
  
  <script src="https://js.stripe.com/v3/"></script>
  
  <style>
    :root {
      --color-bg: #0a0a0b;
      --color-surface: #141416;
      --color-surface-2: #1c1c1f;
      --color-text: #ffffff;
      --color-text-muted: #8a8a8d;
      --color-accent: #00d4aa;
      --color-accent-glow: rgba(0, 212, 170, 0.3);
      --color-accent-hover: #00f5c4;
      --color-warning: #ffc107;
      --color-border: #2a2a2d;
      --font-display: 'Outfit', system-ui, sans-serif;
      --font-mono: 'Space Mono', monospace;
      --radius: 12px;
      --radius-lg: 20px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    /* Anchor offset for smooth scrolling */
    [id] {
      scroll-margin-top: 100px;
    }

    body {
      font-family: var(--font-display);
      background: var(--color-bg);
      color: var(--color-text);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      overflow-x: hidden;
    }

    /* Animated gradient background */
    .bg-gradient {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(ellipse 80% 50% at 20% -20%, rgba(0, 212, 170, 0.15), transparent),
        radial-gradient(ellipse 60% 40% at 80% 100%, rgba(0, 150, 136, 0.1), transparent);
      pointer-events: none;
      z-index: -1;
    }

    /* Grid pattern overlay */
    .bg-grid {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: 
        linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
      background-size: 60px 60px;
      pointer-events: none;
      z-index: -1;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 24px;
    }

    /* Navigation */
    nav {
      padding: 24px 0;
      position: relative;
      z-index: 100;
    }

    .nav-inner {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      text-decoration: none;
    }

    .logo-icon {
      width: 44px;
      height: 44px;
      background: linear-gradient(135deg, var(--color-accent), #00a080);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.4rem;
    }

    .logo-text {
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--color-text);
      letter-spacing: -0.02em;
    }

    .logo-text span {
      color: var(--color-accent);
    }

    .nav-links {
      display: flex;
      gap: 32px;
      list-style: none;
    }

    .nav-links a {
      color: var(--color-text-muted);
      text-decoration: none;
      font-size: 0.95rem;
      font-weight: 500;
      transition: color 0.2s;
    }

    .nav-links a:hover {
      color: var(--color-text);
    }

    /* Hero Section */
    .hero {
      padding: 80px 0 60px;
      text-align: center;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      padding: 8px 16px;
      border-radius: 100px;
      font-size: 0.85rem;
      color: var(--color-text-muted);
      margin-bottom: 32px;
    }

    .badge-dot {
      width: 8px;
      height: 8px;
      background: var(--color-accent);
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .hero h1 {
      font-size: clamp(2.5rem, 6vw, 4rem);
      font-weight: 800;
      line-height: 1.1;
      letter-spacing: -0.03em;
      margin-bottom: 24px;
      background: linear-gradient(135deg, #fff 0%, #ccc 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .hero h1 .accent {
      background: linear-gradient(135deg, var(--color-accent), var(--color-accent-hover));
      -webkit-background-clip: text;
      background-clip: text;
    }

    .hero-subtitle {
      font-size: 1.25rem;
      color: var(--color-text-muted);
      max-width: 600px;
      margin: 0 auto 40px;
      font-weight: 400;
    }

    .hero-price {
      display: inline-flex;
      align-items: baseline;
      gap: 8px;
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      padding: 16px 32px;
      border-radius: var(--radius);
      margin-bottom: 40px;
    }

    .hero-price .amount {
      font-family: var(--font-mono);
      font-size: 2rem;
      font-weight: 700;
      color: var(--color-accent);
    }

    .hero-price .unit {
      font-size: 1rem;
      color: var(--color-text-muted);
    }

    /* Transcription Tool Section */
    .tool-section {
      padding: 40px 0 80px;
    }

    .tool-card {
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-lg);
      overflow: hidden;
      max-width: 700px;
      margin: 0 auto;
    }

    /* Steps indicator */
    .steps {
      display: flex;
      padding: 20px 24px;
      border-bottom: 1px solid var(--color-border);
      background: var(--color-surface-2);
    }

    .step {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 0.85rem;
      font-weight: 500;
      color: var(--color-text-muted);
      transition: color 0.3s ease;
    }

    .step.active {
      color: var(--color-text);
    }

    .step.complete {
      color: var(--color-accent);
    }

    .step-number {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--color-border);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: 600;
      font-family: var(--font-mono);
      transition: all 0.3s ease;
    }

    .step.active .step-number {
      background: var(--color-accent);
      color: var(--color-bg);
    }

    .step.complete .step-number {
      background: var(--color-accent);
      color: var(--color-bg);
    }

    /* Panels */
    .panel {
      padding: 40px 32px;
      display: none;
    }

    .panel.active {
      display: block;
      animation: fadeIn 0.4s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Upload Zone */
    .upload-zone {
      border: 2px dashed var(--color-border);
      border-radius: var(--radius);
      padding: 60px 32px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      background: rgba(0, 212, 170, 0.02);
    }

    .upload-zone:hover,
    .upload-zone.drag-over {
      border-color: var(--color-accent);
      background: rgba(0, 212, 170, 0.05);
    }

    .upload-icon {
      width: 72px;
      height: 72px;
      margin: 0 auto 20px;
      background: linear-gradient(135deg, var(--color-accent), #00a080);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
    }

    .upload-zone h3 {
      font-size: 1.3rem;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .upload-zone p {
      color: var(--color-text-muted);
      font-size: 0.95rem;
    }

    .upload-zone input {
      display: none;
    }

    .formats {
      margin-top: 24px;
      display: flex;
      justify-content: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .format-tag {
      font-family: var(--font-mono);
      font-size: 0.75rem;
      padding: 6px 12px;
      background: var(--color-surface-2);
      border-radius: 6px;
      color: var(--color-text-muted);
    }

    /* Price Panel */
    .file-summary {
      background: var(--color-surface-2);
      border-radius: var(--radius);
      padding: 20px;
      margin-bottom: 28px;
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .file-icon {
      width: 52px;
      height: 52px;
      background: linear-gradient(135deg, var(--color-accent), #00a080);
      border-radius: var(--radius);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.4rem;
      flex-shrink: 0;
    }

    .file-details {
      flex: 1;
      min-width: 0;
    }

    .file-name {
      font-weight: 600;
      font-size: 0.95rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .file-meta {
      font-size: 0.85rem;
      color: var(--color-text-muted);
      font-family: var(--font-mono);
    }

    .price-display {
      text-align: center;
      padding: 40px 0;
      border-top: 1px solid var(--color-border);
      border-bottom: 1px solid var(--color-border);
      margin-bottom: 28px;
    }

    .price-label {
      font-size: 0.9rem;
      color: var(--color-text-muted);
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .price-amount {
      font-family: var(--font-mono);
      font-size: 3.5rem;
      font-weight: 700;
      color: var(--color-accent);
      letter-spacing: -0.02em;
    }

    .price-amount .currency {
      font-size: 1.8rem;
      vertical-align: super;
      margin-right: 4px;
      color: var(--color-text-muted);
    }

    .rate-info {
      font-size: 0.85rem;
      color: var(--color-text-muted);
      margin-top: 12px;
      font-family: var(--font-mono);
    }

    /* Buttons */
    .btn {
      width: 100%;
      padding: 18px 28px;
      font-family: var(--font-display);
      font-size: 1rem;
      font-weight: 600;
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--color-accent), #00a080);
      color: var(--color-bg);
    }

    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px var(--color-accent-glow);
    }

    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .btn-secondary {
      background: transparent;
      color: var(--color-text-muted);
      border: 1px solid var(--color-border);
      margin-top: 12px;
    }

    .btn-secondary:hover {
      background: var(--color-surface-2);
      color: var(--color-text);
    }

    .spinner {
      width: 20px;
      height: 20px;
      border: 2px solid rgba(0,0,0,0.2);
      border-top-color: var(--color-bg);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Processing Panel */
    .processing-content {
      text-align: center;
      padding: 60px 0;
    }

    .processing-animation {
      width: 100px;
      height: 100px;
      margin: 0 auto 32px;
      position: relative;
    }

    .processing-animation::before {
      content: "";
      position: absolute;
      inset: 0;
      border: 3px solid var(--color-border);
      border-top-color: var(--color-accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    .processing-animation::after {
      content: "üéß";
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
    }

    .processing-content h3 {
      font-size: 1.4rem;
      margin-bottom: 10px;
    }

    .processing-content p {
      color: var(--color-text-muted);
    }

    /* Result Panel */
    .result-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 24px;
      flex-wrap: wrap;
      gap: 16px;
    }

    .result-header h3 {
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--color-accent);
    }

    .result-actions {
      display: flex;
      gap: 10px;
    }

    .btn-icon {
      padding: 12px 18px;
      font-size: 0.85rem;
      font-weight: 600;
      background: var(--color-surface-2);
      border: 1px solid var(--color-border);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--color-text);
    }

    .btn-icon:hover {
      background: var(--color-border);
    }

    .transcript-box {
      background: var(--color-surface-2);
      border: 1px solid var(--color-border);
      border-radius: var(--radius);
      padding: 28px;
      max-height: 400px;
      overflow-y: auto;
    }

    .transcript-text {
      font-size: 1rem;
      line-height: 1.9;
      white-space: pre-wrap;
      word-wrap: break-word;
      color: var(--color-text);
    }

    .new-transcription {
      margin-top: 28px;
      text-align: center;
    }

    .new-transcription a {
      color: var(--color-accent);
      text-decoration: none;
      font-weight: 500;
    }

    .new-transcription a:hover {
      text-decoration: underline;
    }

    /* Error */
    .error-box {
      background: rgba(255, 100, 100, 0.1);
      border: 1px solid rgba(255, 100, 100, 0.3);
      border-radius: var(--radius);
      padding: 20px;
      margin: 0 32px 0;
      display: none;
    }

    .error-box.visible {
      display: block;
    }

    .error-box h4 {
      color: #ff6b6b;
      font-size: 0.95rem;
      margin-bottom: 6px;
    }

    .error-box p {
      color: var(--color-text-muted);
      font-size: 0.9rem;
    }

    /* Story Section */
    .story-section {
      padding: 100px 0;
      border-top: 1px solid var(--color-border);
    }

    .story-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 80px;
      align-items: center;
    }

    .story-content h2 {
      font-size: 2.2rem;
      font-weight: 700;
      margin-bottom: 24px;
      letter-spacing: -0.02em;
    }

    .story-content p {
      color: var(--color-text-muted);
      font-size: 1.1rem;
      margin-bottom: 20px;
      line-height: 1.8;
    }

    .story-content .signature {
      margin-top: 32px;
      padding-top: 24px;
      border-top: 1px solid var(--color-border);
    }

    .story-content .signature-name {
      font-weight: 600;
      font-size: 1.1rem;
      color: var(--color-text);
    }

    .story-content .signature-title {
      color: var(--color-text-muted);
      font-size: 0.9rem;
    }

    .story-visual {
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-lg);
      padding: 40px;
      text-align: center;
    }

    .story-visual .big-emoji {
      font-size: 5rem;
      margin-bottom: 24px;
    }

    .story-visual .quote {
      font-size: 1.3rem;
      font-style: italic;
      color: var(--color-text);
      line-height: 1.6;
    }

    .story-visual .quote-mark {
      color: var(--color-accent);
      font-size: 2rem;
    }

    /* Features */
    .features-section {
      padding: 80px 0;
      border-top: 1px solid var(--color-border);
    }

    .features-section h2 {
      text-align: center;
      font-size: 2rem;
      margin-bottom: 60px;
    }

    .features-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 32px;
    }

    .feature-card {
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: var(--radius);
      padding: 32px;
      transition: all 0.3s ease;
    }

    .feature-card:hover {
      border-color: var(--color-accent);
      transform: translateY(-4px);
    }

    .feature-icon {
      font-size: 2.5rem;
      margin-bottom: 20px;
    }

    .feature-card h3 {
      font-size: 1.15rem;
      margin-bottom: 12px;
    }

    .feature-card p {
      color: var(--color-text-muted);
      font-size: 0.95rem;
      line-height: 1.6;
    }

    /* Contact Section */
    .contact-section {
      padding: 100px 0;
      border-top: 1px solid var(--color-border);
    }

    .contact-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 80px;
    }

    .contact-info h2 {
      font-size: 2rem;
      margin-bottom: 20px;
    }

    .contact-info p {
      color: var(--color-text-muted);
      font-size: 1.05rem;
      margin-bottom: 32px;
      line-height: 1.7;
    }

    .contact-details {
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: var(--radius);
      padding: 28px;
    }

    .contact-details h4 {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--color-text-muted);
      margin-bottom: 16px;
    }

    .contact-details p {
      font-size: 0.95rem;
      margin-bottom: 8px;
      color: var(--color-text);
    }

    .contact-details a {
      color: var(--color-accent);
      text-decoration: none;
    }

    .contact-details a:hover {
      text-decoration: underline;
    }

    .contact-form {
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-lg);
      padding: 40px;
    }

    .form-group {
      margin-bottom: 24px;
    }

    .form-group label {
      display: block;
      font-size: 0.9rem;
      font-weight: 500;
      margin-bottom: 10px;
      color: var(--color-text);
    }

    .form-group input,
    .form-group textarea {
      width: 100%;
      padding: 14px 18px;
      background: var(--color-surface-2);
      border: 1px solid var(--color-border);
      border-radius: 8px;
      color: var(--color-text);
      font-family: var(--font-display);
      font-size: 1rem;
      transition: border-color 0.2s;
    }

    .form-group input:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: var(--color-accent);
    }

    .form-group textarea {
      min-height: 140px;
      resize: vertical;
    }

    .form-success {
      display: none;
      text-align: center;
      padding: 40px;
    }

    .form-success.visible {
      display: block;
    }

    .form-success .icon {
      font-size: 3rem;
      margin-bottom: 16px;
    }

    .form-success h3 {
      font-size: 1.3rem;
      margin-bottom: 8px;
    }

    .form-success p {
      color: var(--color-text-muted);
    }

    /* Funding Section */
    .funding-section {
      padding: 100px 0;
      border-top: 1px solid var(--color-border);
      background: linear-gradient(180deg, var(--color-bg) 0%, rgba(0, 212, 170, 0.03) 100%);
    }

    .funding-header {
      text-align: center;
      margin-bottom: 60px;
    }

    .funding-header h2 {
      font-size: 2.2rem;
      margin-bottom: 16px;
    }

    .funding-header p {
      color: var(--color-text-muted);
      font-size: 1.1rem;
      max-width: 600px;
      margin: 0 auto;
    }

    .funding-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 60px;
      align-items: start;
    }

    .funding-info h3 {
      font-size: 1.3rem;
      margin-bottom: 24px;
      color: var(--color-accent);
    }

    .funding-info ul {
      list-style: none;
      margin-bottom: 32px;
    }

    .funding-info li {
      padding: 12px 0;
      border-bottom: 1px solid var(--color-border);
      font-size: 1.05rem;
    }

    .funding-info li:last-child {
      border-bottom: none;
    }

    .funding-note {
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: var(--radius);
      padding: 20px;
    }

    .funding-note p {
      color: var(--color-text-muted);
      font-size: 0.95rem;
      margin: 0;
    }

    .funding-form-container {
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-lg);
      padding: 40px;
    }

    @media (max-width: 968px) {
      .funding-grid {
        grid-template-columns: 1fr;
        gap: 40px;
      }
    }

    /* Footer */
    footer {
      border-top: 1px solid var(--color-border);
      padding: 60px 0 40px;
      background: var(--color-surface);
    }

    .footer-grid {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr 1fr;
      gap: 60px;
      margin-bottom: 60px;
    }

    .footer-brand .logo {
      margin-bottom: 20px;
    }

    .footer-brand p {
      color: var(--color-text-muted);
      font-size: 0.95rem;
      line-height: 1.7;
      max-width: 300px;
    }

    .footer-col h4 {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--color-text-muted);
      margin-bottom: 20px;
    }

    .footer-col ul {
      list-style: none;
    }

    .footer-col li {
      margin-bottom: 12px;
    }

    .footer-col a {
      color: var(--color-text);
      text-decoration: none;
      font-size: 0.95rem;
      transition: color 0.2s;
    }

    .footer-col a:hover {
      color: var(--color-accent);
    }

    .footer-bottom {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 40px;
      border-top: 1px solid var(--color-border);
      flex-wrap: wrap;
      gap: 20px;
    }

    .footer-legal {
      color: var(--color-text-muted);
      font-size: 0.85rem;
    }

    .footer-legal a {
      color: var(--color-text-muted);
      text-decoration: none;
    }

    .footer-legal a:hover {
      color: var(--color-accent);
    }

    .company-badge {
      display: flex;
      align-items: center;
      gap: 12px;
      background: var(--color-surface-2);
      border: 1px solid var(--color-border);
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 0.85rem;
      color: var(--color-text-muted);
    }

    .company-badge img {
      height: 20px;
    }

    .company-badge a {
      color: var(--color-accent);
      text-decoration: none;
    }

    .company-badge a:hover {
      text-decoration: underline;
    }

    /* Responsive */
    @media (max-width: 968px) {
      .story-grid,
      .contact-grid,
      .footer-grid {
        grid-template-columns: 1fr;
        gap: 40px;
      }

      .features-grid {
        grid-template-columns: 1fr;
      }

      .nav-links {
        display: none;
      }
    }

    @media (max-width: 600px) {
      .hero {
        padding: 60px 0 40px;
      }

      .hero h1 {
        font-size: 2rem;
      }

      .panel {
        padding: 28px 20px;
      }

      .steps {
        padding: 16px;
      }

      .step-text {
        display: none;
      }

      .price-amount {
        font-size: 2.5rem;
      }

      .footer-bottom {
        flex-direction: column;
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <div class="bg-gradient"></div>
  <div class="bg-grid"></div>

  <!-- Navigation -->
  <nav>
    <div class="container">
      <div class="nav-inner">
        <a href="/" class="logo">
          <div class="logo-icon">üéß</div>
          <div class="logo-text">audio<span>daddy</span></div>
        </a>
        <ul class="nav-links">
          <li><a href="#transcribe">Transcribe</a></li>
          <li><a href="#story">Our Story</a></li>
          <li><a href="#funding">Funding</a></li>
          <li><a href="#contact">Contact</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero">
    <div class="container">
      <div class="badge">
        <span class="badge-dot"></span>
        No subscriptions. No signups. No nonsense.
      </div>
      <h1>Audio to text,<br><span class="accent">pay only for what you use</span></h1>
      <p class="hero-subtitle">Upload your recording. See the price. Pay. Get your transcript. It's that simple.</p>
      <div class="hero-price">
        <span class="amount" id="heroPrice">From ¬£0.12</span>
        <span class="unit" id="heroRate">+ ¬£0.01/min</span>
      </div>
    </div>
  </section>

  <!-- Transcription Tool -->
  <section class="tool-section" id="transcribe">
    <div class="container">
      <div class="tool-card">
        <!-- Steps -->
        <div class="steps">
          <div class="step active" id="step1">
            <span class="step-number">1</span>
            <span class="step-text">Upload</span>
          </div>
          <div class="step" id="step2">
            <span class="step-number">2</span>
            <span class="step-text">Pay</span>
          </div>
          <div class="step" id="step3">
            <span class="step-number">3</span>
            <span class="step-text">Done</span>
          </div>
        </div>

        <!-- Error Box -->
        <div class="error-box" id="errorBox">
          <h4>‚ö†Ô∏è Something went wrong</h4>
          <p id="errorText"></p>
        </div>

        <!-- Panel 1: Upload -->
        <div class="panel active" id="panelUpload">
          <div class="upload-zone" id="uploadZone">
            <div class="upload-icon">üéµ</div>
            <h3>Drop your audio file here</h3>
            <p>or click to browse</p>
            <input type="file" id="fileInput" accept="audio/*,.mp3,.mp4,.mpeg,.mpga,.m4a,.wav,.webm" />
            <div class="formats">
              <span class="format-tag">MP3</span>
              <span class="format-tag">M4A</span>
              <span class="format-tag">WAV</span>
              <span class="format-tag">MP4</span>
              <span class="format-tag">WEBM</span>
            </div>
          </div>
        </div>

        <!-- Panel 2: Price & Pay -->
        <div class="panel" id="panelPrice">
          <div class="file-summary">
            <div class="file-icon">üéß</div>
            <div class="file-details">
              <div class="file-name" id="fileName"></div>
              <div class="file-meta" id="fileMeta"></div>
            </div>
          </div>

          <div class="price-display">
            <div class="price-label">Your total</div>
            <div class="price-amount">
              <span class="currency">¬£</span><span id="priceValue">0.00</span>
            </div>
            <div class="rate-info"><span id="durationText">0:00</span> @ ¬£<span id="rateDisplay">0.01</span>/min</div>
          </div>

          <!-- Payment Form -->
          <div id="paymentSection" style="display: none; margin-bottom: 24px;">
            <div id="payment-element" style="margin-bottom: 16px;"></div>
            <div id="payment-message" style="color: var(--color-warning); font-size: 0.9rem; margin-bottom: 12px; display: none;"></div>
          </div>

          <button class="btn btn-primary" id="payBtn" onclick="handlePayClick()">
            Pay & Transcribe
          </button>
          <button class="btn btn-secondary" onclick="resetToUpload()">
            Choose different file
          </button>
        </div>

        <!-- Panel 3: Processing -->
        <div class="panel" id="panelProcessing">
          <div class="processing-content">
            <div class="processing-animation"></div>
            <h3>Transcribing your audio...</h3>
            <p id="processingStatus">This usually takes a few seconds</p>
          </div>
        </div>

        <!-- Panel 4: Result -->
        <div class="panel" id="panelResult">
          <div class="result-header">
            <h3>‚úì Transcription complete</h3>
            <div class="result-actions">
              <button class="btn-icon" onclick="copyTranscript()">üìã Copy</button>
              <button class="btn-icon" onclick="downloadTranscript()">üíæ Download</button>
            </div>
          </div>
          <div class="transcript-box">
            <div class="transcript-text" id="transcriptText"></div>
          </div>
          <div class="loyalty-message" id="loyaltyMessage" style="background: rgba(0, 212, 170, 0.1); border: 1px solid var(--color-accent); border-radius: var(--radius); padding: 16px; margin-top: 24px; text-align: center; display: none;">
            <p style="margin: 0; color: var(--color-accent); font-weight: 500;" id="loyaltyText"></p>
          </div>
          <div class="new-transcription">
            <a href="#" onclick="resetToUpload(); return false;">Transcribe another file ‚Üí</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Story Section -->
  <section class="story-section" id="story">
    <div class="container">
      <div class="story-grid">
        <div class="story-content">
          <h2>Why I built this</h2>
          <p>I run a claims management and emergency response company. For compliance, I need to keep records of phone calls with customers and suppliers. Turning those recordings into text was costing me a fortune.</p>
          <p>Every transcription service wanted me on a monthly subscription. ¬£30 here, ¬£50 there. I don't need 500 minutes a month‚ÄîI just need to transcribe a few calls when I need to.</p>
          <p>So I built exactly what I wanted: upload a file, see the price upfront, pay for just that file, get the transcript. No accounts. No recurring charges. No nonsense.</p>
          <p>If it's useful to you too, brilliant. If it's rubbish, tell me‚ÄîI'll fix it.</p>
          <div class="signature">
            <div class="signature-name">Mr Profit</div>
            <div class="signature-title">Founder & Chief Audio Daddy</div>
          </div>
        </div>
        <div class="story-visual">
          <div class="big-emoji">üò§</div>
          <p class="quote">
            <span class="quote-mark">"</span>I just want to pay for what I use. Is that too much to ask?<span class="quote-mark">"</span>
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Features -->
  <section class="features-section">
    <div class="container">
      <h2>Simple. Honest. Done.</h2>
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">üí∞</div>
          <h3>Pay per minute</h3>
          <p id="featurePrice">From ¬£0.12 + ¬£0.01/min. No subscription. Just pay for what you use.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">‚ö°</div>
          <h3>Instant results</h3>
          <p>Powered by OpenAI Whisper, one of the most accurate transcription engines on the planet.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">üîí</div>
          <h3>Private & secure</h3>
          <p>Your audio is processed and deleted. We don't store your files or transcripts.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">üåç</div>
          <h3>Any language</h3>
          <p>Whisper supports 50+ languages. Auto-detected from your audio.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">üì±</div>
          <h3>Works everywhere</h3>
          <p>Desktop, tablet, phone. No app to download. Just open the website.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">ü§ù</div>
          <h3>Human support</h3>
          <p>Got a question? Send me a message. I actually reply.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact Section -->
  <section class="contact-section" id="contact">
    <div class="container">
      <div class="contact-grid">
        <div class="contact-info">
          <h2>Get in touch</h2>
          <p>Got feedback? Found a bug? Want to tell me this is the best thing since sliced bread? Or the worst? I want to hear it.</p>
          <div class="contact-details">
            <h4>Company Details</h4>
            <p><strong>Road and Rescue Ltd</strong></p>
            <p>Company No: 16401492</p>
            <p>71-75 Shelton Street, Covent Garden</p>
            <p>London, WC2H 9JQ, United Kingdom</p>
            <p style="margin-top: 16px;">
              <strong>Support:</strong> <a href="tel:+447501250720">+44 7501 250720</a>
            </p>
            <p style="margin-top: 16px;">
              <a href="https://find-and-update.company-information.service.gov.uk/company/16401492" target="_blank" rel="noopener">View on Companies House ‚Üí</a>
            </p>
          </div>
        </div>
        <div class="contact-form" id="contactFormContainer">
          <form id="contactForm" onsubmit="submitContactForm(event)">
            <div class="form-group">
              <label for="contactName">Your name</label>
              <input type="text" id="contactName" name="name" required placeholder="John Smith" />
            </div>
            <div class="form-group">
              <label for="contactEmail">Email address</label>
              <input type="email" id="contactEmail" name="email" required placeholder="john@example.com" />
            </div>
            <div class="form-group">
              <label for="contactMessage">Message</label>
              <textarea id="contactMessage" name="message" required placeholder="Tell me what you think..."></textarea>
            </div>
            <button type="submit" class="btn btn-primary" id="contactSubmitBtn">
              Send Message
            </button>
          </form>
          <div class="form-success" id="formSuccess">
            <div class="icon">‚úÖ</div>
            <h3>Message sent!</h3>
            <p>I'll get back to you as soon as I can.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Funding Section -->
  <section class="funding-section" id="funding">
    <div class="container">
      <div class="funding-header">
        <h2>üíö Apply for Funding</h2>
        <p>All profits from Audio Daddy go to good works‚Äîcommunity projects, charities, and people who need a hand. If that's you, tell us about it.</p>
      </div>
      <div class="funding-grid">
        <div class="funding-info">
          <h3>What we fund</h3>
          <ul>
            <li>üèòÔ∏è Community projects and local initiatives</li>
            <li>ü§ù Charitable causes and non-profits</li>
            <li>üéì Education and skill-building programmes</li>
            <li>üÜò Emergency assistance for those in need</li>
            <li>üå± Environmental and sustainability projects</li>
          </ul>
          <div class="funding-note">
            <p><strong>No bureaucracy.</strong> Just tell us what you need and why. We read every application personally.</p>
          </div>
        </div>
        <div class="funding-form-container">
          <form id="fundingForm" onsubmit="submitFundingForm(event)">
            <div class="form-group">
              <label for="fundingName">Your name</label>
              <input type="text" id="fundingName" name="name" required placeholder="Jane Smith" />
            </div>
            <div class="form-group">
              <label for="fundingEmail">Email address</label>
              <input type="email" id="fundingEmail" name="email" required placeholder="jane@example.com" />
            </div>
            <div class="form-group">
              <label for="fundingOrg">Organisation (if applicable)</label>
              <input type="text" id="fundingOrg" name="organisation" placeholder="Community Group Name" />
            </div>
            <div class="form-group">
              <label for="fundingAmount">Amount requested (¬£)</label>
              <input type="number" id="fundingAmount" name="amount" placeholder="500" min="1" />
            </div>
            <div class="form-group">
              <label for="fundingProject">Tell us about your project</label>
              <textarea id="fundingProject" name="project" required placeholder="What are you trying to achieve? How will the funding help? Who will benefit?"></textarea>
            </div>
            <button type="submit" class="btn btn-primary" id="fundingSubmitBtn">
              Submit Application
            </button>
          </form>
          <div class="form-success" id="fundingSuccess">
            <div class="icon">üíö</div>
            <h3>Application received!</h3>
            <p>We'll review your application and get back to you soon.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-grid">
        <div class="footer-brand">
          <a href="/" class="logo">
            <div class="logo-icon">üéß</div>
            <div class="logo-text">audio<span>daddy</span></div>
          </a>
          <p>Pay-per-minute audio transcription. Built by an entrepreneur who was sick of subscriptions.</p>
        </div>
        <div class="footer-col">
          <h4>Product</h4>
          <ul>
            <li><a href="#transcribe">Transcribe</a></li>
            <li><a href="#story">Our Story</a></li>
            <li><a href="#funding">Apply for Funding</a></li>
            <li><a href="#contact">Contact</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Legal</h4>
          <ul>
            <li><a href="/privacy.html">Privacy Policy</a></li>
            <li><a href="/terms.html">Terms of Service</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Other Projects</h4>
          <ul>
            <li><a href="https://www.formanpacific.com" target="_blank">Forman Pacific</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <div class="footer-legal">
          ¬© 2025 Road and Rescue Ltd. All rights reserved. | 
          <a href="https://find-and-update.company-information.service.gov.uk/company/16401492" target="_blank">Company No: 16401492</a>
        </div>
        <div class="company-badge">
          üá¨üáß Registered in England & Wales
        </div>
      </div>
    </div>
  </footer>

  <script>
    // ===========================================
    // CONFIGURATION
    // ===========================================
    
    // Base pricing - aggressive floor to get initial sales
    // Will auto-increase as conversion data comes in
    const BASE_MINIMUM = 0.12;       // ¬£0.12 minimum price floor
    const BASE_RATE = 0.01;          // ¬£0.01 per minute floor
    
    // Adjuster settings - will increase as we learn conversion rates
    const ADJUSTER_STEP = 0.25;      // How much to adjust by (¬£0.25)
    const ADJUSTER_MAX = 4.00;       // Max adjuster can add (so max price = ¬£4.50)
    const RATE_STEP = 0.02;          // Rate adjustment step
    const RATE_MAX = 0.20;           // Max rate addition (so max rate = ¬£0.25/min)
    
    // ===========================================
    // DYNAMIC PRICING ENGINE (using CountAPI)
    // ===========================================
    
    const COUNTER_NAMESPACE = 'audiodaddy-uk';
    const COUNTER_API = 'https://api.countapi.xyz';
    const GOOD_CONVERSION = 0.05;     // 5% = good, raise price
    const POOR_CONVERSION = 0.02;     // 2% = poor, lower price
    
    // Get current counts from CountAPI
    async function getVisitorCount() {
      try {
        const res = await fetch(`${COUNTER_API}/get/${COUNTER_NAMESPACE}/visitors`);
        const data = await res.json();
        return data.value || 0;
      } catch (e) { return 0; }
    }
    
    async function getConversionCount() {
      try {
        const res = await fetch(`${COUNTER_API}/get/${COUNTER_NAMESPACE}/conversions`);
        const data = await res.json();
        return data.value || 0;
      } catch (e) { return 0; }
    }
    
    // Increment counters
    async function recordVisit() {
      try {
        const res = await fetch(`${COUNTER_API}/hit/${COUNTER_NAMESPACE}/visitors`);
        const data = await res.json();
        return data.value || 0;
      } catch (e) { return 0; }
    }
    
    async function recordSale() {
      try {
        const res = await fetch(`${COUNTER_API}/hit/${COUNTER_NAMESPACE}/conversions`);
        const data = await res.json();
        return data.value || 0;
      } catch (e) { return 0; }
    }
    
    // Calculate adjuster based on conversion rate
    function calculateAdjuster(visitors, conversions) {
      if (visitors < 10) return 0; // Not enough data
      
      const conversionRate = conversions / visitors;
      
      // Scale adjuster based on conversion rate
      // Higher conversion = we can charge more
      if (conversionRate >= 0.10) {
        return ADJUSTER_MAX; // 10%+ conversion = max price
      } else if (conversionRate >= GOOD_CONVERSION) {
        // Scale between 0.05 and 0.10 ‚Üí adjuster 0.50 to max
        const scale = (conversionRate - GOOD_CONVERSION) / (0.10 - GOOD_CONVERSION);
        return 0.50 + (scale * (ADJUSTER_MAX - 0.50));
      } else if (conversionRate >= POOR_CONVERSION) {
        // Scale between 0.02 and 0.05 ‚Üí adjuster 0 to 0.50
        const scale = (conversionRate - POOR_CONVERSION) / (GOOD_CONVERSION - POOR_CONVERSION);
        return scale * 0.50;
      } else {
        return 0; // Below 2% = floor price
      }
    }
    
    function calculateRateAdjuster(adjuster) {
      // Rate scales proportionally with minimum adjuster
      return (adjuster / ADJUSTER_MAX) * RATE_MAX;
    }
    
    // Load pricing (sync version using cached data)
    let cachedPricing = { adjuster: 0, rateAdjuster: 0, visitors: 0, conversions: 0 };
    
    function loadPricingStats() {
      return cachedPricing;
    }
    
    function savePricingStats(stats) {
      cachedPricing = stats;
    }
    
    // Get current prices (base + adjuster)
    function getCurrentPrices(stats) {
      return {
        minimum: BASE_MINIMUM + Math.max(0, stats.adjuster),
        ratePerMinute: BASE_RATE + Math.max(0, stats.rateAdjuster)
      };
    }
    
    // Record a conversion (called after purchase)
    // Only counts if visitor arrived via Google Ads (gclid)
    async function recordConversion(adjuster, amount) {
      if (isDevMode()) {
        console.log('üîß Dev mode - conversion not counted');
        return;
      }
      
      // Only count conversions from Google Ads sessions
      if (!isGoogleAdsSession()) {
        console.log('üë§ Organic/direct sale - not counted for pricing algorithm');
        return;
      }
      
      const conversions = await recordSale();
      const visitors = await getVisitorCount();
      const rate = visitors > 0 ? conversions / visitors : 0;
      console.log(`üí∞ Google Ads sale recorded! ${conversions}/${visitors} = ${(rate*100).toFixed(1)}% conversion`);
    }
    
    // Admin functions (call from browser console)
    window.pricingAdmin = {
      stats: async () => {
        const visitors = await getVisitorCount();
        const conversions = await getConversionCount();
        const rate = visitors > 0 ? conversions / visitors : 0;
        const adjuster = calculateAdjuster(visitors, conversions);
        const rateAdj = calculateRateAdjuster(adjuster);
        
        console.log('=== LIVE PRICING STATS (CountAPI) ===');
        console.log(`Visitors: ${visitors}`);
        console.log(`Conversions: ${conversions}`);
        console.log(`Conversion rate: ${(rate*100).toFixed(2)}%`);
        console.log('---');
        console.log(`Adjuster: ¬£${adjuster.toFixed(2)}`);
        console.log(`Current minimum: ¬£${(BASE_MINIMUM + adjuster).toFixed(2)}`);
        console.log(`Current rate: ¬£${(BASE_RATE + rateAdj).toFixed(2)}/min`);
        
        return { visitors, conversions, rate, adjuster };
      },
      reset: () => {
        console.log('To reset counters, open these URLs:');
        console.log(`https://api.countapi.xyz/set/${COUNTER_NAMESPACE}/visitors?value=0`);
        console.log(`https://api.countapi.xyz/set/${COUNTER_NAMESPACE}/conversions?value=0`);
      }
    };
    
    // Developer mode - gclid=12345 skips all tracking
    function isDevMode() {
      const params = new URLSearchParams(window.location.search);
      return params.get('gclid') === '12345';
    }
    
    // Check if visitor came from Google Ads (has gclid parameter)
    function isGoogleAdsVisitor() {
      if (isDevMode()) return false; // Dev mode doesn't count
      const params = new URLSearchParams(window.location.search);
      return params.has('gclid') || 
             params.get('utm_source') === 'google' || 
             params.get('utm_medium') === 'cpc';
    }
    
    // Track if this SESSION started from Google Ads (for conversion tracking)
    function markGoogleAdsSession() {
      if (isGoogleAdsVisitor()) {
        sessionStorage.setItem('from_gclid', '1');
      }
    }
    
    // Check if this session started from Google Ads
    function isGoogleAdsSession() {
      return sessionStorage.getItem('from_gclid') === '1';
    }
    
    // Mark visitor as a paying customer (persistent - localStorage)
    function markAsCustomer() {
      localStorage.setItem('audiodaddy_customer', '1');
    }
    
    // Check if returning customer (gets floor price forever)
    function isReturningCustomer() {
      return localStorage.getItem('audiodaddy_customer') === '1';
    }
    
    // Send notification email via Power Automate
    async function sendNotification(type, details = {}) {
      if (isDevMode()) {
        console.log(`üîß Dev mode - ${type} notification not sent`);
        return;
      }
      
      try {
        const formData = {
          formType: 'notification',
          fields: [
            { name: 'type', value: type },
            { name: 'timestamp', value: new Date().toISOString() },
            { name: 'source', value: 'audiodaddy.co.uk' },
            { name: 'isGoogleAds', value: isGoogleAdsSession() ? 'Yes' : 'No' },
            { name: 'isReturningCustomer', value: isReturningCustomer() ? 'Yes' : 'No' },
            ...Object.entries(details).map(([name, value]) => ({ name, value: String(value) }))
          ]
        };
        
        await fetch(CONFIG.endpoints.contact, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(formData)
        });
        
        console.log(`üìß ${type} notification sent`);
      } catch (e) {
        console.log(`Failed to send ${type} notification:`, e);
      }
    }
    
    // Initialize pricing from CountAPI
    let initPricingStats = { adjuster: 0, rateAdjuster: 0, visitors: 0, conversions: 0 };
    
    async function initPricing() {
      // Mark session if they arrived via Google Ads (for conversion tracking later)
      markGoogleAdsSession();
      
      try {
        // Dev mode - skip all tracking, show floor price
        if (isDevMode()) {
          console.log('üîß Dev mode active (gclid=12345) - no tracking, floor price');
          const visitors = await getVisitorCount();
          const conversions = await getConversionCount();
          const adjuster = calculateAdjuster(visitors, conversions);
          const rateAdjuster = calculateRateAdjuster(adjuster);
          initPricingStats = { adjuster, rateAdjuster, visitors, conversions };
          // Dev mode sees floor price (like organic visitors)
          CONFIG.minimumPrice = BASE_MINIMUM;
          CONFIG.ratePerMinute = BASE_RATE;
          CONFIG.adjuster = 0;
          document.getElementById('heroPrice').textContent = `From ¬£${BASE_MINIMUM.toFixed(2)}`;
          document.getElementById('heroRate').textContent = `+ ¬£${BASE_RATE.toFixed(2)}/min`;
          document.getElementById('rateDisplay').textContent = BASE_RATE.toFixed(2);
          if (isReturningCustomer()) {
            document.getElementById('featurePrice').textContent = `Welcome back! You get our best rate: ¬£${BASE_MINIMUM.toFixed(2)} + ¬£${BASE_RATE.toFixed(2)}/min.`;
          } else {
            document.getElementById('featurePrice').textContent = `From ¬£${BASE_MINIMUM.toFixed(2)} + ¬£${BASE_RATE.toFixed(2)}/min. No subscription. Just pay for what you use.`;
          }
          return;
        }
        
        // Only count visitors from Google Ads
        let visitors;
        if (isGoogleAdsVisitor()) {
          visitors = await recordVisit();
          console.log('üìä Google Ads visitor counted');
        } else {
          visitors = await getVisitorCount();
          console.log('üë§ Direct/organic visitor (floor price applies)');
        }
        const conversions = await getConversionCount();
        
        // Calculate adjuster based on actual conversion rate
        const adjuster = calculateAdjuster(visitors, conversions);
        const rateAdjuster = calculateRateAdjuster(adjuster);
        
        // Update pricing
        initPricingStats = { adjuster, rateAdjuster, visitors, conversions };
        const prices = getCurrentPrices(initPricingStats);
        
        // Update CONFIG (for Google Ads visitors)
        CONFIG.minimumPrice = prices.minimum;
        CONFIG.ratePerMinute = prices.ratePerMinute;
        CONFIG.adjuster = adjuster;
        
        // Display prices based on visitor type
        // Returning customers & organic = floor price, First-time Google Ads = dynamic
        const paysFloorPrice = isReturningCustomer() || !isGoogleAdsSession();
        const displayMin = paysFloorPrice ? BASE_MINIMUM : prices.minimum;
        const displayRate = paysFloorPrice ? BASE_RATE : prices.ratePerMinute;
        
        document.getElementById('heroPrice').textContent = `From ¬£${displayMin.toFixed(2)}`;
        document.getElementById('heroRate').textContent = `+ ¬£${displayRate.toFixed(2)}/min`;
        document.getElementById('rateDisplay').textContent = displayRate.toFixed(2);
        
        // Show loyalty message to returning customers
        if (isReturningCustomer()) {
          document.getElementById('featurePrice').textContent = `Welcome back! You get our best rate: ¬£${displayMin.toFixed(2)} + ¬£${displayRate.toFixed(2)}/min.`;
        } else {
          document.getElementById('featurePrice').textContent = `From ¬£${displayMin.toFixed(2)} + ¬£${displayRate.toFixed(2)}/min. No subscription. Just pay for what you use.`;
        }
        
        const rate = visitors > 0 ? (conversions/visitors*100).toFixed(1) : '0.0';
        const priceType = isReturningCustomer() ? 'returning customer' : (isGoogleAdsSession() ? 'dynamic' : 'floor');
        console.log(`üè∑Ô∏è ${priceType} pricing: ¬£${displayMin.toFixed(2)} min | ${visitors} visits, ${conversions} sales, ${rate}% conv`);
        
        // Send visit notification
        sendNotification('visit', {
          priceShown: `¬£${displayMin.toFixed(2)} + ¬£${displayRate.toFixed(2)}/min`,
          visitorCount: visitors,
          conversionCount: conversions,
          conversionRate: `${rate}%`
        });
      } catch (e) {
        console.log('Could not load pricing from CountAPI, using defaults');
      }
    }
    
    // Load pricing on startup (async - updates prices when ready)
    initPricing();
    
    // Initial prices (will be updated by initPricing)
    const currentPrices = getCurrentPrices(initPricingStats);
    
    const CONFIG = {
      // Pricing (GBP) - base + adjuster
      ratePerMinute: currentPrices.ratePerMinute,
      minimumPrice: currentPrices.minimum,
      adjuster: initPricingStats.adjuster,
      currency: 'GBP',
      currencySymbol: '¬£',
      
      // Stripe
      stripePublishableKey: 'pk_live_51SbPdsGS5FVhjJaRdzMH6Hit5Vveay4aAsOtdEPoL6VVzrOarBKz7rQGVmUqI8DtoSGmylm0CIX9mG0W527K3wek003XXZEK93',
      stripePercent: 0.029,
      stripeFixed: 0.20,
      
      // Support contact (required for Stripe)
      supportPhone: '+447501250720',
      
      // Max file size (500MB - we handle chunking for large files)
      maxFileSize: 500 * 1024 * 1024,
      
      // Whisper API limit per chunk
      maxChunkSize: 24 * 1024 * 1024, // 24MB to be safe
      
      // Power Automate endpoints
      endpoints: {
        // Creates PaymentIntent, returns { clientSecret: "pi_..._secret_..." }
        createPaymentIntent: 'https://default61ffc6bcd9ce458b8120d32187c377.0d.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/667f78ea935b41b1bca7bb443f664837/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=1nwjXAiQ_mo29tMu6vBTPo5cO0lNQgPnB5EbL5cOahI',
        // Verifies payment, returns { valid: true, key: "sk-proj-..." }
        verifyPayment: 'https://default61ffc6bcd9ce458b8120d32187c377.0d.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/10456dc3f0314fe3a7476c3352e9d691/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=mdHcU5A73pMcBCrSxaYDPw1Zbae7j0JaOCRy8zN7bpI',
        // Contact form
        contact: 'https://default61ffc6bcd9ce458b8120d32187c377.0d.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/1d9490a2a5294b31b14287e143e5e9b4/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=sMYCU3UAD1M9w9lVkfehzJUYBx4mo5KtE9Ft0iHaBc0'
      }
    };

    // ===========================================
    // STRIPE
    // ===========================================
    const stripe = Stripe(CONFIG.stripePublishableKey);
    let stripeElements = null;
    let paymentElement = null;
    let clientSecret = null;
    let paymentIntentId = null;

    // ===========================================
    // STATE
    // ===========================================
    let state = {
      file: null,
      duration: 0,
      price: 0,
      transcript: '',
      paymentReady: false
    };

    // ===========================================
    // DOM ELEMENTS
    // ===========================================
    const elements = {
      uploadZone: document.getElementById('uploadZone'),
      fileInput: document.getElementById('fileInput'),
      fileName: document.getElementById('fileName'),
      fileMeta: document.getElementById('fileMeta'),
      priceValue: document.getElementById('priceValue'),
      durationText: document.getElementById('durationText'),
      payBtn: document.getElementById('payBtn'),
      transcriptText: document.getElementById('transcriptText'),
      errorBox: document.getElementById('errorBox'),
      errorText: document.getElementById('errorText'),
      panels: {
        upload: document.getElementById('panelUpload'),
        price: document.getElementById('panelPrice'),
        processing: document.getElementById('panelProcessing'),
        result: document.getElementById('panelResult')
      },
      steps: {
        step1: document.getElementById('step1'),
        step2: document.getElementById('step2'),
        step3: document.getElementById('step3')
      }
    };

    // ===========================================
    // INITIALIZATION
    // ===========================================
    document.addEventListener('DOMContentLoaded', () => {
      // Update price displays dynamically
      document.getElementById('heroPrice').textContent = `From ¬£${CONFIG.minimumPrice.toFixed(2)}`;
      document.getElementById('heroRate').textContent = `+ ¬£${CONFIG.ratePerMinute.toFixed(2)}/min`;
      document.getElementById('rateDisplay').textContent = CONFIG.ratePerMinute.toFixed(2);
      document.getElementById('featurePrice').textContent = `From ¬£${CONFIG.minimumPrice.toFixed(2)} + ¬£${CONFIG.ratePerMinute.toFixed(2)}/min. No subscription. Just pay for what you use.`;
      
      // Handle anchor links with smooth scroll
      initAnchorLinks();
      
      // Handle initial hash on page load
      if (window.location.hash) {
        setTimeout(() => {
          const target = document.querySelector(window.location.hash);
          if (target) {
            target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          }
        }, 100);
      }

      // Click to upload
      elements.uploadZone.addEventListener('click', () => {
        elements.fileInput.click();
      });

      // File input change
      elements.fileInput.addEventListener('change', (e) => {
        if (e.target.files.length > 0) {
          handleFile(e.target.files[0]);
        }
      });

      // Drag and drop
      elements.uploadZone.addEventListener('dragover', (e) => {
        e.preventDefault();
        elements.uploadZone.classList.add('drag-over');
      });

      elements.uploadZone.addEventListener('dragleave', () => {
        elements.uploadZone.classList.remove('drag-over');
      });

      elements.uploadZone.addEventListener('drop', (e) => {
        e.preventDefault();
        elements.uploadZone.classList.remove('drag-over');
        if (e.dataTransfer.files.length > 0) {
          handleFile(e.dataTransfer.files[0]);
        }
      });
    });

    // ===========================================
    // FILE HANDLING
    // ===========================================
    function handleFile(file) {
      hideError();

      // Validate file type
      const validExtensions = ['.mp3', '.mp4', '.mpeg', '.mpga', '.m4a', '.wav', '.webm'];
      const hasValidExtension = validExtensions.some(ext => 
        file.name.toLowerCase().endsWith(ext)
      );
      
      if (!hasValidExtension && !file.type.startsWith('audio/')) {
        showError('Please select a valid audio file (MP3, M4A, WAV, MP4, or WEBM)');
        return;
      }

      // Validate file size
      if (file.size > CONFIG.maxFileSize) {
        showError('File size exceeds 500MB limit. Please use a smaller file.');
        return;
      }

      state.file = file;

      // Get duration from audio file
      const audio = new Audio();
      audio.src = URL.createObjectURL(file);
      
      audio.addEventListener('loadedmetadata', () => {
        state.duration = audio.duration;
        URL.revokeObjectURL(audio.src);
        calculatePrice();
        showPricePanel();
      });

      audio.addEventListener('error', () => {
        // Don't estimate - require exact duration
        showError('Could not read audio file duration. Please try a different file format (MP3, M4A, or WAV recommended).');
      });
    }

    // ===========================================
    // PRICING
    // ===========================================
    function calculatePrice() {
      const minutes = state.duration / 60;
      
      // Returning customers & organic visitors get floor price
      // Only first-time Google Ads visitors pay dynamic price
      const paysFloorPrice = isReturningCustomer() || !isGoogleAdsSession();
      const ratePerMinute = paysFloorPrice ? BASE_RATE : CONFIG.ratePerMinute;
      const minimumPrice = paysFloorPrice ? BASE_MINIMUM : CONFIG.minimumPrice;
      
      const baseRevenue = minutes * ratePerMinute;
      
      // Add Stripe fees
      const totalCharge = (baseRevenue + CONFIG.stripeFixed) / (1 - CONFIG.stripePercent);
      
      // Round up, apply minimum
      state.price = Math.max(minimumPrice, Math.round(totalCharge * 100) / 100);
    }

    // ===========================================
    // UI NAVIGATION
    // ===========================================
    function showPanel(panelName) {
      Object.values(elements.panels).forEach(panel => {
        panel.classList.remove('active');
      });
      elements.panels[panelName].classList.add('active');
    }

    function updateSteps(currentStep) {
      const stepOrder = ['step1', 'step2', 'step3'];
      const currentIndex = stepOrder.indexOf(currentStep);

      stepOrder.forEach((step, index) => {
        elements.steps[step].classList.remove('active', 'complete');
        if (index < currentIndex) {
          elements.steps[step].classList.add('complete');
        } else if (index === currentIndex) {
          elements.steps[step].classList.add('active');
        }
      });
    }

    function showPricePanel() {
      elements.fileName.textContent = state.file.name;
      elements.fileMeta.textContent = formatFileSize(state.file.size);
      elements.priceValue.textContent = state.price.toFixed(2);
      elements.durationText.textContent = formatDuration(state.duration);

      updateSteps('step2');
      showPanel('price');
    }

    function resetToUpload() {
      state = { file: null, duration: 0, price: 0, transcript: '', paymentReady: false };
      elements.fileInput.value = '';
      clientSecret = null;
      paymentIntentId = null;
      document.getElementById('paymentSection').style.display = 'none';
      elements.payBtn.innerHTML = 'Pay & Transcribe';
      hideError();
      updateSteps('step1');
      showPanel('upload');
    }

    // ===========================================
    // PAYMENT & TRANSCRIPTION (Inline)
    // ===========================================
    
    async function handlePayClick() {
      const btn = elements.payBtn;
      
      // If payment form not ready, initialize it
      if (!state.paymentReady) {
        btn.disabled = true;
        btn.innerHTML = '<span class="spinner"></span> Loading payment...';
        
        try {
          await initializePayment();
          btn.innerHTML = 'Complete Payment';
          btn.disabled = false;
          state.paymentReady = true;
          // Scroll to payment form
          scrollToPayment();
        } catch (error) {
          showError(error.message || 'Failed to load payment form');
          btn.disabled = false;
          btn.innerHTML = 'Pay & Transcribe';
        }
        return;
      }
      
      // Submit payment
      btn.disabled = true;
      btn.innerHTML = '<span class="spinner"></span> Processing payment...';
      
      try {
        await confirmPayment();
      } catch (error) {
        showError(error.message || 'Payment failed. Please try again.');
        btn.disabled = false;
        btn.innerHTML = 'Complete Payment';
      }
    }
    
    async function initializePayment() {
      // Create PaymentIntent via Power Automate
      const paymentData = {
        amount: Math.round(state.price * 100), // pence
        currency: CONFIG.currency.toLowerCase(),
        fileName: state.file.name,
        durationSeconds: Math.round(state.duration),
        durationFormatted: formatDuration(state.duration),
        source: 'audiodaddy.co.uk'
      };

      const response = await fetch(CONFIG.endpoints.createPaymentIntent, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(paymentData)
      });

      if (!response.ok) {
        throw new Error('Failed to initialize payment');
      }

      const data = await response.json();
      
      if (!data.clientSecret) {
        throw new Error('Invalid payment response');
      }
      
      clientSecret = data.clientSecret;
      paymentIntentId = data.paymentIntentId;
      
      // Initialize Stripe Elements
      stripeElements = stripe.elements({
        clientSecret: clientSecret,
        appearance: {
          theme: 'night',
          variables: {
            colorPrimary: '#00d4aa',
            colorBackground: '#1c1c1f',
            colorText: '#ffffff',
            colorDanger: '#ff6b6b',
            fontFamily: 'Outfit, system-ui, sans-serif',
            borderRadius: '8px'
          }
        }
      });
      
      // Create and mount Payment Element
      paymentElement = stripeElements.create('payment');
      paymentElement.mount('#payment-element');
      
      // Show payment section
      document.getElementById('paymentSection').style.display = 'block';
    }
    
    async function confirmPayment() {
      const { error, paymentIntent } = await stripe.confirmPayment({
        elements: stripeElements,
        redirect: 'if_required'
      });
      
      if (error) {
        throw new Error(error.message);
      }
      
      if (paymentIntent.status === 'succeeded') {
        // Payment successful - now verify and transcribe
        // Pass the actual amount paid (in pence) so we can limit transcription
        await processTranscription(paymentIntent.id, paymentIntent.amount);
      } else {
        throw new Error('Payment was not completed');
      }
    }
    
    async function processTranscription(intentId, amountPaidPence) {
      // Show processing panel
      updateSteps('step3');
      showPanel('processing');
      scrollToTool();
      
      try {
        // Step 1: Verify payment and get API key
        document.getElementById('processingStatus').textContent = 'Verifying payment...';
        
        const verifyResponse = await fetch(CONFIG.endpoints.verifyPayment, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ paymentIntentId: intentId })
        });
        
        const verifyData = await verifyResponse.json();
        
        if (!verifyData.valid || !verifyData.key) {
          throw new Error('Payment verification failed');
        }
        
        // Step 2: Calculate max duration based on what they actually paid
        const amountPaid = amountPaidPence / 100; // Convert pence to pounds
        
        // Track conversion in Google Ads
        gtag('event', 'conversion', {
          'send_to': 'AW-17834457969/R7kpCL7n6dcbEPH2kLhC',
          'value': amountPaid,
          'currency': 'GBP',
          'transaction_id': intentId
        });
        
        // Record conversion for dynamic pricing optimization
        recordConversion(CONFIG.adjuster, amountPaid);
        
        // Log for analytics
        gtag('event', 'purchase', {
          'minimum_price': CONFIG.minimumPrice,
          'adjuster': CONFIG.adjuster,
          'rate_per_minute': CONFIG.ratePerMinute
        });
        const netAfterFees = (amountPaid - CONFIG.stripeFixed) * (1 - CONFIG.stripePercent);
        const maxMinutesPaid = netAfterFees / CONFIG.ratePerMinute;
        const maxSecondsPaid = maxMinutesPaid * 60 * 1.10; // 10% buffer for customer's benefit
        
        // If payment covers the file duration (or more), transcribe everything
        // Otherwise, only transcribe what they paid for
        const maxDuration = maxSecondsPaid >= state.duration ? null : maxSecondsPaid;
        
        // Step 3: Transcribe with OpenAI (respecting the limit if set)
        document.getElementById('processingStatus').textContent = 'Transcribing your audio...';
        
        const transcript = await transcribeWithWhisper(state.file, verifyData.key, maxDuration);
        
        // Step 4: Show result
        state.transcript = transcript;
        elements.transcriptText.textContent = transcript;
        
        // If partial transcript, add a note
        if (maxDuration !== null) {
          elements.transcriptText.textContent += '\n\n---\n[Transcript limited to what was paid for. Upload again and pay full price for complete transcript.]';
        }
        
        // Mark as customer - they get floor price forever now
        markAsCustomer();
        
        // Send purchase notification
        sendNotification('purchase', {
          amount: `¬£${amountPaid.toFixed(2)}`,
          fileName: state.file?.name || 'Unknown',
          duration: formatDuration(state.duration),
          paymentIntentId: intentId
        });
        
        // Show loyalty message with future pricing
        document.getElementById('loyaltyText').textContent = `üéâ Thanks for your purchase! Next time you visit, you'll get our best rate: ¬£${BASE_MINIMUM.toFixed(2)} + ¬£${BASE_RATE.toFixed(2)}/min`;
        document.getElementById('loyaltyMessage').style.display = 'block';
        
        showPanel('result');
        scrollToTool();
        
      } catch (error) {
        console.error('Transcription error:', error);
        showError(error.message || 'Transcription failed. Please contact support.');
        showPanel('price');
        elements.payBtn.disabled = false;
        elements.payBtn.innerHTML = 'Pay & Transcribe';
      }
    }
    
    async function transcribeWithWhisper(file, apiKey, maxDuration = null) {
      // Check if we need to split the file
      if (file.size <= CONFIG.maxChunkSize) {
        // Small file - transcribe directly
        // If there's a duration limit and it's less than the file, we need to trim
        if (maxDuration !== null && maxDuration < state.duration) {
          document.getElementById('processingStatus').textContent = 'Preparing audio...';
          const trimmedFile = await trimAudioFile(file, maxDuration);
          return await transcribeChunk(trimmedFile, apiKey);
        }
        return await transcribeChunk(file, apiKey);
      }
      
      // Large file - split and transcribe in chunks
      document.getElementById('processingStatus').textContent = 'Splitting audio into chunks...';
      
      const chunks = await splitAudioFile(file, maxDuration);
      const transcripts = [];
      
      for (let i = 0; i < chunks.length; i++) {
        document.getElementById('processingStatus').textContent = 
          `Transcribing chunk ${i + 1} of ${chunks.length}...`;
        
        const chunkTranscript = await transcribeChunk(chunks[i], apiKey);
        transcripts.push(chunkTranscript);
      }
      
      // Combine all transcripts
      return transcripts.join(' ');
    }
    
    async function transcribeChunk(file, apiKey) {
      const formData = new FormData();
      formData.append('file', file);
      formData.append('model', 'whisper-1');
      formData.append('response_format', 'text');
      
      const response = await fetch('https://api.openai.com/v1/audio/transcriptions', {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${apiKey}`
        },
        body: formData
      });
      
      if (!response.ok) {
        const errorData = await response.json().catch(() => ({}));
        throw new Error(errorData.error?.message || 'Transcription failed');
      }
      
      return await response.text();
    }
    
    async function splitAudioFile(file, maxDuration = null) {
      // Decode audio file
      const arrayBuffer = await file.arrayBuffer();
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
      
      // Calculate chunk duration based on file size ratio
      // If maxDuration is set, only process up to that point
      const totalDuration = maxDuration !== null 
        ? Math.min(audioBuffer.duration, maxDuration) 
        : audioBuffer.duration;
      
      const numChunks = Math.ceil((totalDuration / audioBuffer.duration) * file.size / CONFIG.maxChunkSize);
      const chunkDuration = totalDuration / Math.max(1, numChunks);
      
      const chunks = [];
      
      for (let i = 0; i < numChunks; i++) {
        const startTime = i * chunkDuration;
        const endTime = Math.min((i + 1) * chunkDuration, totalDuration);
        
        // Extract chunk from audio buffer
        const chunkBuffer = extractAudioChunk(audioContext, audioBuffer, startTime, endTime);
        
        // Convert to WAV blob
        const wavBlob = audioBufferToWav(chunkBuffer);
        
        // Create file from blob
        const chunkFile = new File([wavBlob], `chunk_${i}.wav`, { type: 'audio/wav' });
        chunks.push(chunkFile);
      }
      
      await audioContext.close();
      return chunks;
    }
    
    async function trimAudioFile(file, maxDuration) {
      // Decode audio file
      const arrayBuffer = await file.arrayBuffer();
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
      
      // Extract only up to maxDuration
      const trimmedBuffer = extractAudioChunk(audioContext, audioBuffer, 0, maxDuration);
      
      // Convert to WAV blob
      const wavBlob = audioBufferToWav(trimmedBuffer);
      
      await audioContext.close();
      
      // Create file from blob
      return new File([wavBlob], 'trimmed_audio.wav', { type: 'audio/wav' });
    }
    
    function extractAudioChunk(audioContext, audioBuffer, startTime, endTime) {
      const sampleRate = audioBuffer.sampleRate;
      const startSample = Math.floor(startTime * sampleRate);
      const endSample = Math.floor(endTime * sampleRate);
      const frameCount = endSample - startSample;
      
      const chunkBuffer = audioContext.createBuffer(
        audioBuffer.numberOfChannels,
        frameCount,
        sampleRate
      );
      
      for (let channel = 0; channel < audioBuffer.numberOfChannels; channel++) {
        const sourceData = audioBuffer.getChannelData(channel);
        const destData = chunkBuffer.getChannelData(channel);
        for (let i = 0; i < frameCount; i++) {
          destData[i] = sourceData[startSample + i];
        }
      }
      
      return chunkBuffer;
    }
    
    function audioBufferToWav(audioBuffer) {
      const numChannels = audioBuffer.numberOfChannels;
      const sampleRate = audioBuffer.sampleRate;
      const format = 1; // PCM
      const bitDepth = 16;
      
      const bytesPerSample = bitDepth / 8;
      const blockAlign = numChannels * bytesPerSample;
      
      const samples = audioBuffer.length;
      const dataSize = samples * blockAlign;
      const buffer = new ArrayBuffer(44 + dataSize);
      const view = new DataView(buffer);
      
      // WAV header
      writeString(view, 0, 'RIFF');
      view.setUint32(4, 36 + dataSize, true);
      writeString(view, 8, 'WAVE');
      writeString(view, 12, 'fmt ');
      view.setUint32(16, 16, true);
      view.setUint16(20, format, true);
      view.setUint16(22, numChannels, true);
      view.setUint32(24, sampleRate, true);
      view.setUint32(28, sampleRate * blockAlign, true);
      view.setUint16(32, blockAlign, true);
      view.setUint16(34, bitDepth, true);
      writeString(view, 36, 'data');
      view.setUint32(40, dataSize, true);
      
      // Write audio data
      const offset = 44;
      for (let i = 0; i < samples; i++) {
        for (let channel = 0; channel < numChannels; channel++) {
          const sample = audioBuffer.getChannelData(channel)[i];
          const intSample = Math.max(-1, Math.min(1, sample)) * 0x7FFF;
          view.setInt16(offset + (i * blockAlign) + (channel * bytesPerSample), intSample, true);
        }
      }
      
      return new Blob([buffer], { type: 'audio/wav' });
    }
    
    function writeString(view, offset, string) {
      for (let i = 0; i < string.length; i++) {
        view.setUint8(offset + i, string.charCodeAt(i));
      }
    }

    // ===========================================
    // RESULT ACTIONS
    // ===========================================
    function copyTranscript() {
      navigator.clipboard.writeText(state.transcript).then(() => {
        const btn = event.target.closest('.btn-icon');
        const original = btn.innerHTML;
        btn.innerHTML = '‚úì Copied!';
        setTimeout(() => { btn.innerHTML = original; }, 2000);
      });
    }

    function downloadTranscript() {
      const blob = new Blob([state.transcript], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = (state.file?.name?.replace(/\.[^/.]+$/, '') || 'transcript') + '.txt';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    // ===========================================
    // CONTACT FORM
    // ===========================================
    async function submitContactForm(e) {
      e.preventDefault();
      
      const btn = document.getElementById('contactSubmitBtn');
      const form = document.getElementById('contactForm');
      const success = document.getElementById('formSuccess');
      
      btn.disabled = true;
      btn.innerHTML = '<span class="spinner"></span> Sending...';
      
      const formData = {
        formType: 'contact',
        fields: [
          { name: 'name', value: document.getElementById('contactName').value },
          { name: 'email', value: document.getElementById('contactEmail').value },
          { name: 'message', value: document.getElementById('contactMessage').value },
          { name: 'source', value: 'audiodaddy.co.uk' },
          { name: 'timestamp', value: new Date().toISOString() }
        ]
      };

      try {
        await fetch(CONFIG.endpoints.contact, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(formData)
        });
        
        form.style.display = 'none';
        success.classList.add('visible');
        
      } catch (error) {
        alert('Failed to send message. Please try again.');
        btn.disabled = false;
        btn.innerHTML = 'Send Message';
      }
    }

    // ===========================================
    // FUNDING FORM
    // ===========================================
    async function submitFundingForm(e) {
      e.preventDefault();
      
      const btn = document.getElementById('fundingSubmitBtn');
      const form = document.getElementById('fundingForm');
      const success = document.getElementById('fundingSuccess');
      
      btn.disabled = true;
      btn.innerHTML = '<span class="spinner"></span> Submitting...';
      
      const formData = {
        formType: 'funding',
        fields: [
          { name: 'name', value: document.getElementById('fundingName').value },
          { name: 'email', value: document.getElementById('fundingEmail').value },
          { name: 'organisation', value: document.getElementById('fundingOrg').value || 'N/A' },
          { name: 'amount', value: document.getElementById('fundingAmount').value || 'Not specified' },
          { name: 'project', value: document.getElementById('fundingProject').value },
          { name: 'source', value: 'audiodaddy.co.uk' },
          { name: 'timestamp', value: new Date().toISOString() }
        ]
      };

      try {
        await fetch(CONFIG.endpoints.contact, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(formData)
        });
        
        form.style.display = 'none';
        success.classList.add('visible');
        
      } catch (error) {
        alert('Failed to submit application. Please try again.');
        btn.disabled = false;
        btn.innerHTML = 'Submit Application';
      }
    }

    // ===========================================
    // ERROR HANDLING
    // ===========================================
    function showError(message) {
      elements.errorText.textContent = message;
      elements.errorBox.classList.add('visible');
    }

    function hideError() {
      elements.errorBox.classList.remove('visible');
    }

    // ===========================================
    // UTILITIES
    // ===========================================
    function formatFileSize(bytes) {
      if (bytes < 1024) return bytes + ' B';
      if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
      return (bytes / (1024 * 1024)).toFixed(2) + ' MB';
    }

    function formatDuration(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins}:${secs.toString().padStart(2, '0')}`;
    }

    function initAnchorLinks() {
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
          const href = this.getAttribute('href');
          if (href === '#') return; // Skip empty anchors
          
          const target = document.querySelector(href);
          if (target) {
            e.preventDefault();
            target.scrollIntoView({ behavior: 'smooth', block: 'start' });
            // Update URL without triggering scroll
            history.pushState(null, null, href);
          }
        });
      });
    }

    function scrollToTool() {
      const toolCard = document.querySelector('.tool-card');
      if (toolCard) {
        setTimeout(() => {
          toolCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 100);
      }
    }

    function scrollToPayment() {
      const paymentSection = document.getElementById('paymentSection');
      if (paymentSection) {
        setTimeout(() => {
          paymentSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 150);
      }
    }
  </script>
</body>
</html>
